{% extends 'base.html' %}
{% load static %}

{% block title %}Budgets - FinanceTracker{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/budgets.css' %}">
{% endblock %}

{% block content %}
<div class="app-container">
    {% include 'partials/sidebar.html' %}

    <main class="main-content" id="mainContent">
        <div class="page-header">
            <div>
                <h1>Budgets</h1>
                <p class="page-subtitle">Set and track your spending limits.</p>
            </div>
            <button class="btn-primary" onclick="openModal('budgetModal')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"/>
                    <line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
                Add Budget
            </button>
        </div>

        <div class="budgets-grid">
            {% for budget in budgets %}
            <div class="budget-card">
                <div class="budget-header">
                    <div class="budget-info">
                        <div class="budget-icon" style="background-color: {{ budget.category.color }};">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 6v6l4 2"/>
                            </svg>
                        </div>
                        <div class="budget-details">
                            <h3>{{ budget.category.name }}</h3>
                            <p class="budget-month">{{ budget.month|date:"F Y" }}</p>
                        </div>
                    </div>
                    {% if budget.percentage > 90 %}
                    <div class="budget-alert">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                            <line x1="12" y1="9" x2="12" y2="13"/>
                            <line x1="12" y1="17" x2="12.01" y2="17"/>
                        </svg>
                        Alert
                    </div>
                    {% endif %}
                </div>

                <div class="budget-stats">
                    <div class="budget-stat">
                        <span>Budget</span>
                        <span>${{ budget.amount|floatformat:2 }}</span>
                    </div>
                    <div class="budget-stat">
                        <span>Spent</span>
                        <span>${{ budget.spent|floatformat:2 }}</span>
                    </div>
                    <div class="budget-stat remaining {% if budget.remaining < 0 %}negative{% else %}positive{% endif %}">
                        <span>Remaining</span>
                        <span>${{ budget.remaining|floatformat:2 }}</span>
                    </div>
                </div>

                <div class="budget-progress-section">
                    <div class="budget-progress-header">
                        <span class="budget-progress-label">Progress</span>
                        <span class="budget-progress-percent {% if budget.percentage > 100 %}over{% else %}normal{% endif %}">
                            {{ budget.percentage|floatformat:0 }}%
                        </span>
                    </div>
                    <div class="budget-progress-bar">
                        <div class="budget-progress-fill {% if budget.percentage > 100 %}over{% else %}normal{% endif %}" 
                             style="width: {{ budget.percentage|floatformat:0 }}%;"></div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Budget Tips -->
        <div class="budget-tips">
            <h3>Budget Tips</h3>
            <div class="tips-grid">
                <div class="tip-card">
                    <h4>Track Daily</h4>
                    <p>Monitor your spending daily to stay within budget limits.</p>
                </div>
                <div class="tip-card">
                    <h4>Set Realistic Goals</h4>
                    <p>Create achievable budgets based on your spending patterns.</p>
                </div>
                <div class="tip-card">
                    <h4>Review Monthly</h4>
                    <p>Analyze your budget performance and adjust for next month.</p>
                </div>
            </div>
        </div>
    </main>
</div>

{% include 'partials/budget_modal.html' %}
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/budgets.js' %}"></script>
<script src="{% static 'js/modal.js' %}"></script>
{% endblock %}